<!DOCTYPE html>
<html>
<head>
    <title>My Web App</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/theme/material-darker.min.css">
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">

    <script src="https://cdn.jsdelivr.net/npm/typescript@5.4.2/lib/typescript.js"></script>

    <script src="https://unpkg.com/chai@4.5.0/chai.js"></script>
    <script src="https://unpkg.com/mocha@11.0.0/mocha.js"></script>

    <script src="https://unpkg.com/@tailwindcss/browser@4" ></script>

    <link rel="stylesheet" href="/app.css">
</head>
<body class="bg-[#A8B2CA] ">

<div class="grid grid-cols-3 h-full ">

    <div class="m-2  bg-white rounded-xl overflow-hidden">

        <section class="grid  grid-cols-2 p-4 bg-[#EFEFEF] text-[#201e2e] font-bold">
            <div class="text-left">–ó–∞–¥–∞–Ω–∏–µ</div>
        </section>


        <section class="bg-grey p-4" id="theExercise">

            <!-- –ó–¥–µ—Å—å –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–æ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ -->

        </section>

    </div>

    <!-- –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –∫–æ–ª–æ–Ω–∫–∞ -->

    <div class="m-2  bg-[#212121] rounded-xl overflow-hidden font-bold relative">

        <section id="theEditor"> </section>

        <button onclick="app.run()" class="bg-[#444444] text-white px-4 py-2 rounded-lg cursor-pointer z-10 absolute bottom-5 right-5 " > –ó–∞–ø—É—Å—Ç–∏—Ç—å </button>

    </div>

    <!-- –ü—Ä–∞–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞   -->

    <div class="h-screen grid grid-rows-[auto_1fr] pr-4 ">

        <div class="m-2 bg-white  rounded-xl overflow-hidden font-bold">

            <section class="p-4 bg-[#EFEFEF]  text-[#201e2e] ">
                <p class="">–†–µ–∑—É–ª—å—Ç–∞—Ç –∏ –æ—à–∏–±–∫–∏</p>
            </section>

            <section id="theOutput" class="p-4 text-xs"> </section>
            <section id="theConsole" class="p-4 text-xs">  </section>

        </div>

        <div class="m-2 bg-white rounded-xl overflow-hidden relative">

            <div id="theTestResults" >

            </div>

        </div>

    </div>
</div>



<template id="exercise">

    <h2 class="text-2xl">
        {{exercise.title}}
    </h2>

    <!-- –¢–µ–∫—Å—Ç —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è -->

    <div class="text mt-3">
        {{{ exercise.text }}}
    </div>


</template>

<template id="output">

    {{#if errors}}
        <h2>–û—à–∏–±–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏:</h2>
        {{#each errors}}
        <p>üö®{{this.message}}</p>
        {{/each}}
    {{else}}
        <pre>{{code}}</pre>
    {{/if}}

    <iframe id="output__iframe" srcdoc="{{srcdoc}}"> </iframe>

</template>


<template id="editor">

    <div class="editor__header grid p-4 bg-[#15141F] text-[#777]">
        <p class=""> {{ fields.0.file_name}}</p>
    </div>


    <div class="editor__body mt-4">
        <textarea id="editor__ide">{{fields.0.value}}</textarea>
    </div>

</template>


<template id="testResults">

    {{#if (eq errors.length 0)}}

    <button onclick="app.check()" class="absolute right-3 top-2 bg-[#3CC39E] text-white px-4 py-2 rounded-lg cursor-pointer" > –ü—Ä–æ–≤–µ—Ä–∏—Ç—å </button>

    {{#if completed}}
        <section class="grid p-4 bg-[#3FC39E] text-[#ffffff]] font-bold">
            <p class="">–ó–∞–¥–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ! –ö–æ–¥ IDKFA</p>
        </section>
        {{else}}

        <section class="grid p-4 bg-[#EFEFEF] text-[#201e2e]] font-bold">
            <p class="">–í—ã–ø–æ–ª–Ω–µ–Ω–æ {{countTrue tests "passed"}} –∏–∑ {{tests.length}}</p>
        </section>

        {{/if}}

        <div class="p-4">
            {{#each tests}}
            <p>
                {{#if this.passed}} ‚úÖ {{else}} ‚ùå {{/if}}
                {{this.title}}
            </p>
            {{/each}}
        </div>

    {{else}}
        <section class="grid p-4 bg-[#EFEFEF] text-[#201e2e]] font-bold">
            <p class="">–û—à–∏–±–∫–∏ –≤ –∫–æ–¥–µ, –Ω–µ–ª—å–∑—è –ø—Ä–æ–≤–µ—Ä–∏—Ç—å.</p>
        </section>
    {{/if}}

</template>

<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/codemirror.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/mode/javascript/javascript.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/handlebars@latest/dist/handlebars.js"></script>


<script src="/test_runner.js"></script>
<script src="/component.class.js"></script>
<script src="/task.class.js"></script>
<script src="/app.js"></script>

<script>

const urlObj = new URL(window.location.href);
const taskID = urlObj.pathname.split('/').filter(Boolean).pop()
console.log(taskID)

const app = new App(taskID).start()
app.testRunner = new TestRunner()

</script>


</body>
</html>