this.CM=this.CM||{},this.CM.language=function(t,e,r){"use strict";const n=1024;let i=0;class s{constructor(t,e){this.from=t,this.to=e}}class o{constructor(t={}){this.id=i++,this.perNode=!!t.perNode,this.deserialize=t.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(t){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return"function"!=typeof t&&(t=h.match(t)),e=>{let r=t(e);return void 0===r?null:[this,r]}}}o.closedBy=new o({deserialize:t=>t.split(" ")}),o.openedBy=new o({deserialize:t=>t.split(" ")}),o.group=new o({deserialize:t=>t.split(" ")}),o.isolate=new o({deserialize:t=>{if(t&&"rtl"!=t&&"ltr"!=t&&"auto"!=t)throw new RangeError("Invalid value for isolate: "+t);return t||"auto"}}),o.contextHash=new o({perNode:!0}),o.lookAhead=new o({perNode:!0}),o.mounted=new o({perNode:!0});class l{constructor(t,e,r){this.tree=t,this.overlay=e,this.parser=r}static get(t){return t&&t.props&&t.props[o.mounted.id]}}const a=Object.create(null);class h{constructor(t,e,r,n=0){this.name=t,this.props=e,this.id=r,this.flags=n}static define(t){let e=t.props&&t.props.length?Object.create(null):a,r=(t.top?1:0)|(t.skipped?2:0)|(t.error?4:0)|(null==t.name?8:0),n=new h(t.name||"",e,t.id,r);if(t.props)for(let r of t.props)if(Array.isArray(r)||(r=r(n)),r){if(r[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");e[r[0].id]=r[1]}return n}prop(t){return this.props[t.id]}get isTop(){return(1&this.flags)>0}get isSkipped(){return(2&this.flags)>0}get isError(){return(4&this.flags)>0}get isAnonymous(){return(8&this.flags)>0}is(t){if("string"==typeof t){if(this.name==t)return!0;let e=this.prop(o.group);return!!e&&e.indexOf(t)>-1}return this.id==t}static match(t){let e=Object.create(null);for(let r in t)for(let n of r.split(" "))e[n]=t[r];return t=>{for(let r=t.prop(o.group),n=-1;n<(r?r.length:0);n++){let i=e[n<0?t.name:r[n]];if(i)return i}}}}h.none=new h("",Object.create(null),0,8);class u{constructor(t){this.types=t;for(let e=0;e<t.length;e++)if(t[e].id!=e)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...t){let e=[];for(let r of this.types){let n=null;for(let e of t){let t=e(r);t&&(n||(n=Object.assign({},r.props)),n[t[0].id]=t[1])}e.push(n?new h(r.name,n,r.id,r.flags):r)}return new u(e)}}const f=new WeakMap,c=new WeakMap;var d;!function(t){t[t.ExcludeBuffers=1]="ExcludeBuffers",t[t.IncludeAnonymous=2]="IncludeAnonymous",t[t.IgnoreMounts=4]="IgnoreMounts",t[t.IgnoreOverlays=8]="IgnoreOverlays"}(d||(d={}));class p{constructor(t,e,r,n,i){if(this.type=t,this.children=e,this.positions=r,this.length=n,this.props=null,i&&i.length){this.props=Object.create(null);for(let[t,e]of i)this.props["number"==typeof t?t:t.id]=e}}toString(){let t=l.get(this);if(t&&!t.overlay)return t.tree.toString();let e="";for(let t of this.children){let r=t.toString();r&&(e&&(e+=","),e+=r)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(e.length?"("+e+")":""):e}cursor(t=0){return new P(this.topNode,t)}cursorAt(t,e=0,r=0){let n=f.get(this)||this.topNode,i=new P(n);return i.moveTo(t,e),f.set(this,i._tree),i}get topNode(){return new x(this,0,0,null)}resolve(t,e=0){let r=y(f.get(this)||this.topNode,t,e,!1);return f.set(this,r),r}resolveInner(t,e=0){let r=y(c.get(this)||this.topNode,t,e,!0);return c.set(this,r),r}resolveStack(t,e=0){return function(t,e,r){let n=t.resolveInner(e,r),i=null;for(let t=n instanceof x?n:n.context.parent;t;t=t.parent)if(t.index<0){let s=t.parent;(i||(i=[n])).push(s.resolve(e,r)),t=s}else{let s=l.get(t.tree);if(s&&s.overlay&&s.overlay[0].from<=e&&s.overlay[s.overlay.length-1].to>=e){let o=new x(s.tree,s.overlay[0].from+t.from,-1,t);(i||(i=[n])).push(y(o,e,r,!1))}}return i?A(i):n}(this,t,e)}iterate(t){let{enter:e,leave:r,from:n=0,to:i=this.length}=t,s=t.mode||0,o=(s&d.IncludeAnonymous)>0;for(let t=this.cursor(s|d.IncludeAnonymous);;){let s=!1;if(t.from<=i&&t.to>=n&&(!o&&t.type.isAnonymous||!1!==e(t))){if(t.firstChild())continue;s=!0}for(;s&&r&&(o||!t.type.isAnonymous)&&r(t),!t.nextSibling();){if(!t.parent())return;s=!0}}}prop(t){return t.perNode?this.props?this.props[t.id]:void 0:this.type.prop(t)}get propValues(){let t=[];if(this.props)for(let e in this.props)t.push([+e,this.props[e]]);return t}balance(t={}){return this.children.length<=8?this:D(h.none,this.children,this.positions,0,this.children.length,0,this.length,((t,e,r)=>new p(this.type,t,e,r,this.propValues)),t.makeTree||((t,e,r)=>new p(h.none,t,e,r)))}static build(t){return function(t){var e;let{buffer:r,nodeSet:i,maxBufferLength:s=n,reused:l=[],minRepeatType:a=i.types.length}=t,h=Array.isArray(r)?new g(r,r.length):r,u=i.types,f=0,c=0;function d(t,e,r,n,o,p){let{id:g,start:S,end:C,size:A}=h,N=c,P=f;for(;A<0;){if(h.next(),-1==A){let e=l[g];return r.push(e),void n.push(S-t)}if(-3==A)return void(f=g);if(-4==A)return void(c=g);throw new RangeError(`Unrecognized record size: ${A}`)}let T,I,O=u[g],E=S-t;if(C-S<=s&&(I=w(h.pos-e,o))){let e=new Uint16Array(I.size-I.skip),r=h.pos-I.size,n=e.length;for(;h.pos>r;)n=v(I.start,e,n);T=new m(e,C-I.start,i),E=I.start-t}else{let t=h.pos-A;h.next();let e=[],r=[],n=g>=a?g:-1,i=0,o=C;for(;h.pos>t;)n>=0&&h.id==n&&h.size>=0?(h.end<=o-s&&(k(e,r,S,i,h.end,o,n,N,P),i=e.length,o=h.end),h.next()):p>2500?b(S,t,e,r):d(S,t,e,r,n,p+1);if(n>=0&&i>0&&i<e.length&&k(e,r,S,i,S,o,n,N,P),e.reverse(),r.reverse(),n>-1&&i>0){let t=y(O,P);T=D(O,e,r,0,e.length,0,C-S,t,t)}else T=x(O,e,r,C-S,N-C,P)}r.push(T),n.push(E)}function b(t,e,r,n){let o=[],l=0,a=-1;for(;h.pos>e;){let{id:t,start:e,end:r,size:n}=h;if(n>4)h.next();else{if(a>-1&&e<a)break;a<0&&(a=r-s),o.push(t,e,r),l++,h.next()}}if(l){let e=new Uint16Array(4*l),s=o[o.length-2];for(let t=o.length-3,r=0;t>=0;t-=3)e[r++]=o[t],e[r++]=o[t+1]-s,e[r++]=o[t+2]-s,e[r++]=r;r.push(new m(e,o[2]-s,i)),n.push(s-t)}}function y(t,e){return(r,n,i)=>{let s,l,a=0,h=r.length-1;if(h>=0&&(s=r[h])instanceof p){if(!h&&s.type==t&&s.length==i)return s;(l=s.prop(o.lookAhead))&&(a=n[h]+s.length+l)}return x(t,r,n,i,a,e)}}function k(t,e,r,n,s,o,l,a,h){let u=[],f=[];for(;t.length>n;)u.push(t.pop()),f.push(e.pop()+r-s);t.push(x(i.types[l],u,f,o-s,a-o,h)),e.push(s-r)}function x(t,e,r,n,i,s,l){if(s){let t=[o.contextHash,s];l=l?[t].concat(l):[t]}if(i>25){let t=[o.lookAhead,i];l=l?[t].concat(l):[t]}return new p(t,e,r,n,l)}function w(t,e){let r=h.fork(),n=0,i=0,o=0,l=r.end-s,u={size:0,start:0,skip:0};t:for(let s=r.pos-t;r.pos>s;){let t=r.size;if(r.id==e&&t>=0){u.size=n,u.start=i,u.skip=o,o+=4,n+=4,r.next();continue}let h=r.pos-t;if(t<0||h<s||r.start<l)break;let f=r.id>=a?4:0,c=r.start;for(r.next();r.pos>h;){if(r.size<0){if(-3!=r.size)break t;f+=4}else r.id>=a&&(f+=4);r.next()}i=c,n+=t,o+=f}return(e<0||n==t)&&(u.size=n,u.start=i,u.skip=o),u.size>4?u:void 0}function v(t,e,r){let{id:n,start:i,end:s,size:o}=h;if(h.next(),o>=0&&n<a){let l=r;if(o>4){let n=h.pos-(o-4);for(;h.pos>n;)r=v(t,e,r)}e[--r]=l,e[--r]=s-t,e[--r]=i-t,e[--r]=n}else-3==o?f=n:-4==o&&(c=n);return r}let S=[],C=[];for(;h.pos>0;)d(t.start||0,t.bufferStart||0,S,C,-1,0);let A=null!==(e=t.length)&&void 0!==e?e:S.length?C[0]+S[0].length:0;return new p(u[t.topID],S.reverse(),C.reverse(),A)}(t)}}p.empty=new p(h.none,[],[],0);class g{constructor(t,e){this.buffer=t,this.index=e}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new g(this.buffer,this.index)}}class m{constructor(t,e,r){this.buffer=t,this.length=e,this.set=r}get type(){return h.none}toString(){let t=[];for(let e=0;e<this.buffer.length;)t.push(this.childString(e)),e=this.buffer[e+3];return t.join(",")}childString(t){let e=this.buffer[t],r=this.buffer[t+3],n=this.set.types[e],i=n.name;if(/\W/.test(i)&&!n.isError&&(i=JSON.stringify(i)),r==(t+=4))return i;let s=[];for(;t<r;)s.push(this.childString(t)),t=this.buffer[t+3];return i+"("+s.join(",")+")"}findChild(t,e,r,n,i){let{buffer:s}=this,o=-1;for(let l=t;l!=e&&!(b(i,n,s[l+1],s[l+2])&&(o=l,r>0));l=s[l+3]);return o}slice(t,e,r){let n=this.buffer,i=new Uint16Array(e-t),s=0;for(let o=t,l=0;o<e;){i[l++]=n[o++],i[l++]=n[o++]-r;let e=i[l++]=n[o++]-r;i[l++]=n[o++]-t,s=Math.max(s,e)}return new m(i,s,this.set)}}function b(t,e,r,n){switch(t){case-2:return r<e;case-1:return n>=e&&r<e;case 0:return r<e&&n>e;case 1:return r<=e&&n>e;case 2:return n>e;case 4:return!0}}function y(t,e,r,n){for(var i;t.from==t.to||(r<1?t.from>=e:t.from>e)||(r>-1?t.to<=e:t.to<e);){let e=!n&&t instanceof x&&t.index<0?null:t.parent;if(!e)return t;t=e}let s=n?0:d.IgnoreOverlays;if(n)for(let n=t,o=n.parent;o;n=o,o=n.parent)n instanceof x&&n.index<0&&(null===(i=o.enter(e,r,s))||void 0===i?void 0:i.from)!=n.from&&(t=o);for(;;){let n=t.enter(e,r,s);if(!n)return t;t=n}}class k{cursor(t=0){return new P(this,t)}getChild(t,e=null,r=null){let n=w(this,t,e,r);return n.length?n[0]:null}getChildren(t,e=null,r=null){return w(this,t,e,r)}resolve(t,e=0){return y(this,t,e,!1)}resolveInner(t,e=0){return y(this,t,e,!0)}matchContext(t){return v(this.parent,t)}enterUnfinishedNodesBefore(t){let e=this.childBefore(t),r=this;for(;e;){let t=e.lastChild;if(!t||t.to!=e.to)break;t.type.isError&&t.from==t.to?(r=e,e=t.prevSibling):e=t}return r}get node(){return this}get next(){return this.parent}}class x extends k{constructor(t,e,r,n){super(),this._tree=t,this.from=e,this.index=r,this._parent=n}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(t,e,r,n,i=0){for(let s=this;;){for(let{children:o,positions:a}=s._tree,h=e>0?o.length:-1;t!=h;t+=e){let h=o[t],u=a[t]+s.from;if(b(n,r,u,u+h.length))if(h instanceof m){if(i&d.ExcludeBuffers)continue;let o=h.findChild(0,h.buffer.length,e,r-u,n);if(o>-1)return new C(new S(s,h,t,u),null,o)}else if(i&d.IncludeAnonymous||!h.type.isAnonymous||T(h)){let o;if(!(i&d.IgnoreMounts)&&(o=l.get(h))&&!o.overlay)return new x(o.tree,u,t,s);let a=new x(h,u,t,s);return i&d.IncludeAnonymous||!a.type.isAnonymous?a:a.nextChild(e<0?h.children.length-1:0,e,r,n)}}if(i&d.IncludeAnonymous||!s.type.isAnonymous)return null;if(t=s.index>=0?s.index+e:e<0?-1:s._parent._tree.children.length,s=s._parent,!s)return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(t){return this.nextChild(0,1,t,2)}childBefore(t){return this.nextChild(this._tree.children.length-1,-1,t,-2)}enter(t,e,r=0){let n;if(!(r&d.IgnoreOverlays)&&(n=l.get(this._tree))&&n.overlay){let r=t-this.from;for(let{from:t,to:i}of n.overlay)if((e>0?t<=r:t<r)&&(e<0?i>=r:i>r))return new x(n.tree,n.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,t,e,r)}nextSignificantParent(){let t=this;for(;t.type.isAnonymous&&t._parent;)t=t._parent;return t}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function w(t,e,r,n){let i=t.cursor(),s=[];if(!i.firstChild())return s;if(null!=r)for(let t=!1;!t;)if(t=i.type.is(r),!i.nextSibling())return s;for(;;){if(null!=n&&i.type.is(n))return s;if(i.type.is(e)&&s.push(i.node),!i.nextSibling())return null==n?s:[]}}function v(t,e,r=e.length-1){for(let n=t;r>=0;n=n.parent){if(!n)return!1;if(!n.type.isAnonymous){if(e[r]&&e[r]!=n.name)return!1;r--}}return!0}class S{constructor(t,e,r,n){this.parent=t,this.buffer=e,this.index=r,this.start=n}}class C extends k{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(t,e,r){super(),this.context=t,this._parent=e,this.index=r,this.type=t.buffer.set.types[t.buffer.buffer[r]]}child(t,e,r){let{buffer:n}=this.context,i=n.findChild(this.index+4,n.buffer[this.index+3],t,e-this.context.start,r);return i<0?null:new C(this.context,this,i)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(t){return this.child(1,t,2)}childBefore(t){return this.child(-1,t,-2)}enter(t,e,r=0){if(r&d.ExcludeBuffers)return null;let{buffer:n}=this.context,i=n.findChild(this.index+4,n.buffer[this.index+3],e>0?1:-1,t-this.context.start,e);return i<0?null:new C(this.context,this,i)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(t){return this._parent?null:this.context.parent.nextChild(this.context.index+t,t,0,4)}get nextSibling(){let{buffer:t}=this.context,e=t.buffer[this.index+3];return e<(this._parent?t.buffer[this._parent.index+3]:t.buffer.length)?new C(this.context,this._parent,e):this.externalSibling(1)}get prevSibling(){let{buffer:t}=this.context,e=this._parent?this._parent.index+4:0;return this.index==e?this.externalSibling(-1):new C(this.context,this._parent,t.findChild(e,this.index,-1,0,4))}get tree(){return null}toTree(){let t=[],e=[],{buffer:r}=this.context,n=this.index+4,i=r.buffer[this.index+3];if(i>n){let s=r.buffer[this.index+1];t.push(r.slice(n,i,s)),e.push(0)}return new p(this.type,t,e,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function A(t){if(!t.length)return null;let e=0,r=t[0];for(let n=1;n<t.length;n++){let i=t[n];(i.from>r.from||i.to<r.to)&&(r=i,e=n)}let n=r instanceof x&&r.index<0?null:r.parent,i=t.slice();return n?i[e]=n:i.splice(e,1),new N(i,r)}class N{constructor(t,e){this.heads=t,this.node=e}get next(){return A(this.heads)}}class P{get name(){return this.type.name}constructor(t,e=0){if(this.mode=e,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,t instanceof x)this.yieldNode(t);else{this._tree=t.context.parent,this.buffer=t.context;for(let e=t._parent;e;e=e._parent)this.stack.unshift(e.index);this.bufferNode=t,this.yieldBuf(t.index)}}yieldNode(t){return!!t&&(this._tree=t,this.type=t.type,this.from=t.from,this.to=t.to,!0)}yieldBuf(t,e){this.index=t;let{start:r,buffer:n}=this.buffer;return this.type=e||n.set.types[n.buffer[t]],this.from=r+n.buffer[t+1],this.to=r+n.buffer[t+2],!0}yield(t){return!!t&&(t instanceof x?(this.buffer=null,this.yieldNode(t)):(this.buffer=t.context,this.yieldBuf(t.index,t.type)))}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(t,e,r){if(!this.buffer)return this.yield(this._tree.nextChild(t<0?this._tree._tree.children.length-1:0,t,e,r,this.mode));let{buffer:n}=this.buffer,i=n.findChild(this.index+4,n.buffer[this.index+3],t,e-this.buffer.start,r);return!(i<0)&&(this.stack.push(this.index),this.yieldBuf(i))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(t){return this.enterChild(1,t,2)}childBefore(t){return this.enterChild(-1,t,-2)}enter(t,e,r=this.mode){return this.buffer?!(r&d.ExcludeBuffers)&&this.enterChild(1,t,e):this.yield(this._tree.enter(t,e,r))}parent(){if(!this.buffer)return this.yieldNode(this.mode&d.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let t=this.mode&d.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(t)}sibling(t){if(!this.buffer)return!!this._tree._parent&&this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+t,t,0,4,this.mode));let{buffer:e}=this.buffer,r=this.stack.length-1;if(t<0){let t=r<0?0:this.stack[r]+4;if(this.index!=t)return this.yieldBuf(e.findChild(t,this.index,-1,0,4))}else{let t=e.buffer[this.index+3];if(t<(r<0?e.buffer.length:e.buffer[this.stack[r]+3]))return this.yieldBuf(t)}return r<0&&this.yield(this.buffer.parent.nextChild(this.buffer.index+t,t,0,4,this.mode))}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(t){let e,r,{buffer:n}=this;if(n){if(t>0){if(this.index<n.buffer.buffer.length)return!1}else for(let t=0;t<this.index;t++)if(n.buffer.buffer[t+3]<this.index)return!1;({index:e,parent:r}=n)}else({index:e,_parent:r}=this._tree);for(;r;({index:e,_parent:r}=r))if(e>-1)for(let n=e+t,i=t<0?-1:r._tree.children.length;n!=i;n+=t){let t=r._tree.children[n];if(this.mode&d.IncludeAnonymous||t instanceof m||!t.type.isAnonymous||T(t))return!1}return!0}move(t,e){if(e&&this.enterChild(t,0,4))return!0;for(;;){if(this.sibling(t))return!0;if(this.atLastNode(t)||!this.parent())return!1}}next(t=!0){return this.move(1,t)}prev(t=!0){return this.move(-1,t)}moveTo(t,e=0){for(;(this.from==this.to||(e<1?this.from>=t:this.from>t)||(e>-1?this.to<=t:this.to<t))&&this.parent(););for(;this.enterChild(1,t,e););return this}get node(){if(!this.buffer)return this._tree;let t=this.bufferNode,e=null,r=0;if(t&&t.context==this.buffer)t:for(let n=this.index,i=this.stack.length;i>=0;){for(let s=t;s;s=s._parent)if(s.index==n){if(n==this.index)return s;e=s,r=i+1;break t}n=this.stack[--i]}for(let t=r;t<this.stack.length;t++)e=new C(this.buffer,e,this.stack[t]);return this.bufferNode=new C(this.buffer,e,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(t,e){for(let r=0;;){let n=!1;if(this.type.isAnonymous||!1!==t(this)){if(this.firstChild()){r++;continue}this.type.isAnonymous||(n=!0)}for(;;){if(n&&e&&e(this),n=this.type.isAnonymous,!r)return;if(this.nextSibling())break;this.parent(),r--,n=!0}}}matchContext(t){if(!this.buffer)return v(this.node.parent,t);let{buffer:e}=this.buffer,{types:r}=e.set;for(let n=t.length-1,i=this.stack.length-1;n>=0;i--){if(i<0)return v(this._tree,t,n);let s=r[e.buffer[this.stack[i]]];if(!s.isAnonymous){if(t[n]&&t[n]!=s.name)return!1;n--}}return!0}}function T(t){return t.children.some((t=>t instanceof m||!t.type.isAnonymous||T(t)))}const I=new WeakMap;function O(t,e){if(!t.isAnonymous||e instanceof m||e.type!=t)return 1;let r=I.get(e);if(null==r){r=1;for(let n of e.children){if(n.type!=t||!(n instanceof p)){r=1;break}r+=O(t,n)}I.set(e,r)}return r}function D(t,e,r,n,i,s,o,l,a){let h=0;for(let r=n;r<i;r++)h+=O(t,e[r]);let u=Math.ceil(1.5*h/8),f=[],c=[];return function e(r,n,i,o,l){for(let h=i;h<o;){let i=h,d=n[h],p=O(t,r[h]);for(h++;h<o;h++){let e=O(t,r[h]);if(p+e>=u)break;p+=e}if(h==i+1){if(p>u){let t=r[i];e(t.children,t.positions,0,t.children.length,n[i]+l);continue}f.push(r[i])}else{let e=n[h-1]+r[h-1].length-d;f.push(D(t,r,n,i,h,d,e,null,a))}c.push(d+l-s)}}(e,r,n,i,0),(l||a)(f,c,o)}class E{constructor(t,e,r,n,i=!1,s=!1){this.from=t,this.to=e,this.tree=r,this.offset=n,this.open=(i?1:0)|(s?2:0)}get openStart(){return(1&this.open)>0}get openEnd(){return(2&this.open)>0}static addTree(t,e=[],r=!1){let n=[new E(0,t.length,t,0,!1,r)];for(let r of e)r.to>t.length&&n.push(r);return n}static applyChanges(t,e,r=128){if(!e.length)return t;let n=[],i=1,s=t.length?t[0]:null;for(let o=0,l=0,a=0;;o++){let h=o<e.length?e[o]:null,u=h?h.fromA:1e9;if(u-l>=r)for(;s&&s.from<u;){let e=s;if(l>=e.from||u<=e.to||a){let t=Math.max(e.from,l)-a,r=Math.min(e.to,u)-a;e=t>=r?null:new E(t,r,e.tree,e.offset+a,o>0,!!h)}if(e&&n.push(e),s.to>u)break;s=i<t.length?t[i++]:null}if(!h)break;l=h.toA,a=h.toA-h.toB}return n}}class M{startParse(t,e,r){return"string"==typeof t&&(t=new B(t)),r=r?r.length?r.map((t=>new s(t.from,t.to))):[new s(0,0)]:[new s(0,t.length)],this.createParse(t,e||[],r)}parse(t,e,r){let n=this.startParse(t,e,r);for(;;){let t=n.advance();if(t)return t}}}class B{constructor(t){this.string=t}get length(){return this.string.length}chunk(t){return this.string.slice(t)}get lineChunks(){return!1}read(t,e){return this.string.slice(t,e)}}new o({perNode:!0});let _=0;class R{constructor(t,e,r,n){this.name=t,this.set=e,this.base=r,this.modified=n,this.id=_++}toString(){let{name:t}=this;for(let e of this.modified)e.name&&(t=`${e.name}(${t})`);return t}static define(t,e){let r="string"==typeof t?t:"?";if(t instanceof R&&(e=t),null==e?void 0:e.base)throw new Error("Can not derive from a modified tag");let n=new R(r,[],null,[]);if(n.set.push(n),e)for(let t of e.set)n.set.push(t);return n}static defineModifier(t){let e=new z(t);return t=>t.modified.indexOf(e)>-1?t:z.get(t.base||t,t.modified.concat(e).sort(((t,e)=>t.id-e.id)))}}let L=0;class z{constructor(t){this.name=t,this.instances=[],this.id=L++}static get(t,e){if(!e.length)return t;let r=e[0].instances.find((r=>{return r.base==t&&(n=e,i=r.modified,n.length==i.length&&n.every(((t,e)=>t==i[e])));var n,i}));if(r)return r;let n=[],i=new R(t.name,n,t,e);for(let t of e)t.instances.push(i);let s=function(t){let e=[[]];for(let r=0;r<t.length;r++)for(let n=0,i=e.length;n<i;n++)e.push(e[n].concat(t[r]));return e.sort(((t,e)=>e.length-t.length))}(e);for(let e of t.set)if(!e.modified.length)for(let t of s)n.push(z.get(e,t));return i}}function V(t){let e=Object.create(null);for(let r in t){let n=t[r];Array.isArray(n)||(n=[n]);for(let t of r.split(" "))if(t){let r=[],i=2,s=t;for(let e=0;;){if("..."==s&&e>0&&e+3==t.length){i=1;break}let n=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(s);if(!n)throw new RangeError("Invalid path: "+t);if(r.push("*"==n[0]?"":'"'==n[0][0]?JSON.parse(n[0]):n[0]),e+=n[0].length,e==t.length)break;let o=t[e++];if(e==t.length&&"!"==o){i=0;break}if("/"!=o)throw new RangeError("Invalid path: "+t);s=t.slice(e)}let o=r.length-1,l=r[o];if(!l)throw new RangeError("Invalid path: "+t);let a=new F(n,i,o>0?r.slice(0,o):null);e[l]=a.sort(e[l])}}return j.add(e)}const j=new o;class F{constructor(t,e,r,n){this.tags=t,this.mode=e,this.context=r,this.next=n}get opaque(){return 0==this.mode}get inherit(){return 1==this.mode}sort(t){return!t||t.depth<this.depth?(this.next=t,this):(t.next=this.sort(t.next),t)}get depth(){return this.context?this.context.length:0}}function W(t,e){let r=Object.create(null);for(let e of t)if(Array.isArray(e.tag))for(let t of e.tag)r[t.id]=e.class;else r[e.tag.id]=e.class;let{scope:n,all:i=null}=e||{};return{style:t=>{let e=i;for(let n of t)for(let t of n.set){let n=r[t.id];if(n){e=e?e+" "+n:n;break}}return e},scope:n}}function U(t,e,r,n=0,i=t.length){let s=new $(n,Array.isArray(e)?e:[e],r);s.highlightRange(t.cursor(),n,i,"",s.highlighters),s.flush(i)}F.empty=new F([],2,null);class ${constructor(t,e,r){this.at=t,this.highlighters=e,this.span=r,this.class=""}startSpan(t,e){e!=this.class&&(this.flush(t),t>this.at&&(this.at=t),this.class=e)}flush(t){t>this.at&&this.class&&this.span(this.at,t,this.class)}highlightRange(t,e,r,n,i){let{type:s,from:l,to:a}=t;if(l>=r||a<=e)return;s.isTop&&(i=this.highlighters.filter((t=>!t.scope||t.scope(s))));let h=n,u=function(t){let e=t.type.prop(j);for(;e&&e.context&&!t.matchContext(e.context);)e=e.next;return e||null}(t)||F.empty,f=function(t,e){let r=null;for(let n of t){let t=n.style(e);t&&(r=r?r+" "+t:t)}return r}(i,u.tags);if(f&&(h&&(h+=" "),h+=f,1==u.mode&&(n+=(n?" ":"")+f)),this.startSpan(Math.max(e,l),h),u.opaque)return;let c=t.tree&&t.tree.prop(o.mounted);if(c&&c.overlay){let s=t.node.enter(c.overlay[0].from+l,1),o=this.highlighters.filter((t=>!t.scope||t.scope(c.tree.type))),u=t.firstChild();for(let f=0,d=l;;f++){let p=f<c.overlay.length?c.overlay[f]:null,g=p?p.from+l:a,m=Math.max(e,d),b=Math.min(r,g);if(m<b&&u)for(;t.from<b&&(this.highlightRange(t,m,b,n,i),this.startSpan(Math.min(b,t.to),h),!(t.to>=g)&&t.nextSibling()););if(!p||g>r)break;d=p.to+l,d>e&&(this.highlightRange(s.cursor(),Math.max(e,p.from+l),Math.min(r,d),"",o),this.startSpan(Math.min(r,d),h))}u&&t.parent()}else if(t.firstChild()){c&&(n="");do{if(!(t.to<=e)){if(t.from>=r)break;this.highlightRange(t,e,r,n,i),this.startSpan(Math.min(r,t.to),h)}}while(t.nextSibling());t.parent()}}}const q=R.define,H=q(),J=q(),G=q(J),K=q(J),Z=q(),Q=q(Z),X=q(Z),Y=q(),tt=q(Y),et=q(),rt=q(),nt=q(),it=q(nt),st=q(),ot={comment:H,lineComment:q(H),blockComment:q(H),docComment:q(H),name:J,variableName:q(J),typeName:G,tagName:q(G),propertyName:K,attributeName:q(K),className:q(J),labelName:q(J),namespace:q(J),macroName:q(J),literal:Z,string:Q,docString:q(Q),character:q(Q),attributeValue:q(Q),number:X,integer:q(X),float:q(X),bool:q(Z),regexp:q(Z),escape:q(Z),color:q(Z),url:q(Z),keyword:et,self:q(et),null:q(et),atom:q(et),unit:q(et),modifier:q(et),operatorKeyword:q(et),controlKeyword:q(et),definitionKeyword:q(et),moduleKeyword:q(et),operator:rt,derefOperator:q(rt),arithmeticOperator:q(rt),logicOperator:q(rt),bitwiseOperator:q(rt),compareOperator:q(rt),updateOperator:q(rt),definitionOperator:q(rt),typeOperator:q(rt),controlOperator:q(rt),punctuation:nt,separator:q(nt),bracket:it,angleBracket:q(it),squareBracket:q(it),paren:q(it),brace:q(it),content:Y,heading:tt,heading1:q(tt),heading2:q(tt),heading3:q(tt),heading4:q(tt),heading5:q(tt),heading6:q(tt),contentSeparator:q(Y),list:q(Y),quote:q(Y),emphasis:q(Y),strong:q(Y),link:q(Y),monospace:q(Y),strikethrough:q(Y),inserted:q(),deleted:q(),changed:q(),invalid:q(),meta:st,documentMeta:q(st),annotation:q(st),processingInstruction:q(st),definition:R.defineModifier("definition"),constant:R.defineModifier("constant"),function:R.defineModifier("function"),standard:R.defineModifier("standard"),local:R.defineModifier("local"),special:R.defineModifier("special")};for(let t in ot){let e=ot[t];e instanceof R&&(e.name=t)}W([{tag:ot.link,class:"tok-link"},{tag:ot.heading,class:"tok-heading"},{tag:ot.emphasis,class:"tok-emphasis"},{tag:ot.strong,class:"tok-strong"},{tag:ot.keyword,class:"tok-keyword"},{tag:ot.atom,class:"tok-atom"},{tag:ot.bool,class:"tok-bool"},{tag:ot.url,class:"tok-url"},{tag:ot.labelName,class:"tok-labelName"},{tag:ot.inserted,class:"tok-inserted"},{tag:ot.deleted,class:"tok-deleted"},{tag:ot.literal,class:"tok-literal"},{tag:ot.string,class:"tok-string"},{tag:ot.number,class:"tok-number"},{tag:[ot.regexp,ot.escape,ot.special(ot.string)],class:"tok-string2"},{tag:ot.variableName,class:"tok-variableName"},{tag:ot.local(ot.variableName),class:"tok-variableName tok-local"},{tag:ot.definition(ot.variableName),class:"tok-variableName tok-definition"},{tag:ot.special(ot.variableName),class:"tok-variableName2"},{tag:ot.definition(ot.propertyName),class:"tok-propertyName tok-definition"},{tag:ot.typeName,class:"tok-typeName"},{tag:ot.namespace,class:"tok-namespace"},{tag:ot.className,class:"tok-className"},{tag:ot.macroName,class:"tok-macroName"},{tag:ot.propertyName,class:"tok-propertyName"},{tag:ot.operator,class:"tok-operator"},{tag:ot.comment,class:"tok-comment"},{tag:ot.meta,class:"tok-meta"},{tag:ot.invalid,class:"tok-invalid"},{tag:ot.punctuation,class:"tok-punctuation"}]);const lt="undefined"==typeof Symbol?"__ͼ":Symbol.for("ͼ"),at="undefined"==typeof Symbol?"__styleSet"+Math.floor(1e8*Math.random()):Symbol("styleSet"),ht="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:{};class ut{constructor(t,e){this.rules=[];let{finish:r}=e||{};function n(t){return/^@/.test(t)?[t]:t.split(/,\s*/)}function i(t,e,s,o){let l=[],a=/^@(\w+)\b/.exec(t[0]),h=a&&"keyframes"==a[1];if(a&&null==e)return s.push(t[0]+";");for(let r in e){let o=e[r];if(/&/.test(r))i(r.split(/,\s*/).map((e=>t.map((t=>e.replace(/&/,t))))).reduce(((t,e)=>t.concat(e))),o,s);else if(o&&"object"==typeof o){if(!a)throw new RangeError("The value of a property ("+r+") should be a primitive value.");i(n(r),o,l,h)}else null!=o&&l.push(r.replace(/_.*/,"").replace(/[A-Z]/g,(t=>"-"+t.toLowerCase()))+": "+o+";")}(l.length||h)&&s.push((!r||a||o?t:t.map(r)).join(", ")+" {"+l.join(" ")+"}")}for(let e in t)i(n(e),t[e],this.rules)}getRules(){return this.rules.join("\n")}static newName(){let t=ht[lt]||1;return ht[lt]=t+1,"ͼ"+t.toString(36)}static mount(t,e,r){let n=t[at],i=r&&r.nonce;n?i&&n.setNonce(i):n=new ct(t,i),n.mount(Array.isArray(e)?e:[e],t)}}let ft=new Map;class ct{constructor(t,e){let r=t.ownerDocument||t,n=r.defaultView;if(!t.head&&t.adoptedStyleSheets&&n.CSSStyleSheet){let e=ft.get(r);if(e)return t[at]=e;this.sheet=new n.CSSStyleSheet,ft.set(r,this)}else this.styleTag=r.createElement("style"),e&&this.styleTag.setAttribute("nonce",e);this.modules=[],t[at]=this}mount(t,e){let r=this.sheet,n=0,i=0;for(let e=0;e<t.length;e++){let s=t[e],o=this.modules.indexOf(s);if(o<i&&o>-1&&(this.modules.splice(o,1),i--,o=-1),-1==o){if(this.modules.splice(i++,0,s),r)for(let t=0;t<s.rules.length;t++)r.insertRule(s.rules[t],n++)}else{for(;i<o;)n+=this.modules[i++].rules.length;n+=s.rules.length,i++}}if(r)e.adoptedStyleSheets.indexOf(this.sheet)<0&&(e.adoptedStyleSheets=[this.sheet,...e.adoptedStyleSheets]);else{let t="";for(let e=0;e<this.modules.length;e++)t+=this.modules[e].getRules()+"\n";this.styleTag.textContent=t;let r=e.head||e;this.styleTag.parentNode!=r&&r.insertBefore(this.styleTag,r.firstChild)}}setNonce(t){this.styleTag&&this.styleTag.getAttribute("nonce")!=t&&this.styleTag.setAttribute("nonce",t)}}var dt;const pt=new o;function gt(t){return e.Facet.define({combine:t?e=>e.concat(t):void 0})}const mt=new o;class bt{constructor(t,r,n=[],i=""){this.data=t,this.name=i,e.EditorState.prototype.hasOwnProperty("tree")||Object.defineProperty(e.EditorState.prototype,"tree",{get(){return xt(this)}}),this.parser=r,this.extension=[Ot.of(this),e.EditorState.languageData.of(((t,e,r)=>{let n=yt(t,e,r),i=n.type.prop(pt);if(!i)return[];let s=t.facet(i),o=n.type.prop(mt);if(o){let i=n.resolve(e-n.from,r);for(let e of o)if(e.test(i,t)){let r=t.facet(e.facet);return"replace"==e.type?r:r.concat(s)}}return s}))].concat(n)}isActiveAt(t,e,r=-1){return yt(t,e,r).type.prop(pt)==this.data}findRegions(t){let e=t.facet(Ot);if((null==e?void 0:e.data)==this.data)return[{from:0,to:t.doc.length}];if(!e||!e.allowsNesting)return[];let r=[],n=(t,e)=>{if(t.prop(pt)==this.data)return void r.push({from:e,to:e+t.length});let i=t.prop(o.mounted);if(i){if(i.tree.prop(pt)==this.data){if(i.overlay)for(let t of i.overlay)r.push({from:t.from+e,to:t.to+e});else r.push({from:e,to:e+t.length});return}if(i.overlay){let t=r.length;if(n(i.tree,i.overlay[0].from+e),r.length>t)return}}for(let r=0;r<t.children.length;r++){let i=t.children[r];i instanceof p&&n(i,t.positions[r]+e)}};return n(xt(t),0),r}get allowsNesting(){return!0}}function yt(t,e,r){let n=t.facet(Ot),i=xt(t).topNode;if(!n||n.allowsNesting)for(let t=i;t;t=t.enter(e,r,d.ExcludeBuffers))t.type.isTop&&(i=t);return i}bt.setState=e.StateEffect.define();class kt extends bt{constructor(t,e,r){super(t,e,[],r),this.parser=e}static define(t){let e=gt(t.languageData);return new kt(e,t.parser.configure({props:[pt.add((t=>t.isTop?e:void 0))]}),t.name)}configure(t,e){return new kt(this.data,this.parser.configure(t),e||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function xt(t){let e=t.field(bt.state,!1);return e?e.tree:p.empty}function wt(t,e,r=50){var n;let i=null===(n=t.field(bt.state,!1))||void 0===n?void 0:n.context;if(!i)return null;let s=i.viewport;i.updateViewport({from:0,to:e});let o=i.isDone(e)||i.work(r,e)?i.tree:null;return i.updateViewport(s),o}class vt{constructor(t){this.doc=t,this.cursorPos=0,this.string="",this.cursor=t.iter()}get length(){return this.doc.length}syncTo(t){return this.string=this.cursor.next(t-this.cursorPos).value,this.cursorPos=t+this.string.length,this.cursorPos-this.string.length}chunk(t){return this.syncTo(t),this.string}get lineChunks(){return!0}read(t,e){let r=this.cursorPos-this.string.length;return t<r||e>=this.cursorPos?this.doc.sliceString(t,e):this.string.slice(t-r,e-r)}}let St=null;class Ct{constructor(t,e,r=[],n,i,s,o,l){this.parser=t,this.state=e,this.fragments=r,this.tree=n,this.treeLen=i,this.viewport=s,this.skipped=o,this.scheduleOn=l,this.parse=null,this.tempSkipped=[]}static create(t,e,r){return new Ct(t,e,[],p.empty,0,r,[],null)}startParse(){return this.parser.startParse(new vt(this.state.doc),this.fragments)}work(t,e){return null!=e&&e>=this.state.doc.length&&(e=void 0),this.tree!=p.empty&&this.isDone(null!=e?e:this.state.doc.length)?(this.takeTree(),!0):this.withContext((()=>{var r;if("number"==typeof t){let e=Date.now()+t;t=()=>Date.now()>e}for(this.parse||(this.parse=this.startParse()),null!=e&&(null==this.parse.stoppedAt||this.parse.stoppedAt>e)&&e<this.state.doc.length&&this.parse.stopAt(e);;){let n=this.parse.advance();if(n){if(this.fragments=this.withoutTempSkipped(E.addTree(n,this.fragments,null!=this.parse.stoppedAt)),this.treeLen=null!==(r=this.parse.stoppedAt)&&void 0!==r?r:this.state.doc.length,this.tree=n,this.parse=null,!(this.treeLen<(null!=e?e:this.state.doc.length)))return!0;this.parse=this.startParse()}if(t())return!1}}))}takeTree(){let t,e;this.parse&&(t=this.parse.parsedPos)>=this.treeLen&&((null==this.parse.stoppedAt||this.parse.stoppedAt>t)&&this.parse.stopAt(t),this.withContext((()=>{for(;!(e=this.parse.advance()););})),this.treeLen=t,this.tree=e,this.fragments=this.withoutTempSkipped(E.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(t){let e=St;St=this;try{return t()}finally{St=e}}withoutTempSkipped(t){for(let e;e=this.tempSkipped.pop();)t=At(t,e.from,e.to);return t}changes(t,e){let{fragments:r,tree:n,treeLen:i,viewport:s,skipped:o}=this;if(this.takeTree(),!t.empty){let e=[];if(t.iterChangedRanges(((t,r,n,i)=>e.push({fromA:t,toA:r,fromB:n,toB:i}))),r=E.applyChanges(r,e),n=p.empty,i=0,s={from:t.mapPos(s.from,-1),to:t.mapPos(s.to,1)},this.skipped.length){o=[];for(let e of this.skipped){let r=t.mapPos(e.from,1),n=t.mapPos(e.to,-1);r<n&&o.push({from:r,to:n})}}}return new Ct(this.parser,e,r,n,i,s,o,this.scheduleOn)}updateViewport(t){if(this.viewport.from==t.from&&this.viewport.to==t.to)return!1;this.viewport=t;let e=this.skipped.length;for(let e=0;e<this.skipped.length;e++){let{from:r,to:n}=this.skipped[e];r<t.to&&n>t.from&&(this.fragments=At(this.fragments,r,n),this.skipped.splice(e--,1))}return!(this.skipped.length>=e)&&(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(t,e){this.skipped.push({from:t,to:e})}static getSkippingParser(t){return new class extends M{createParse(e,r,n){let i=n[0].from,s=n[n.length-1].to;return{parsedPos:i,advance(){let e=St;if(e){for(let t of n)e.tempSkipped.push(t);t&&(e.scheduleOn=e.scheduleOn?Promise.all([e.scheduleOn,t]):t)}return this.parsedPos=s,new p(h.none,[],[],s-i)},stoppedAt:null,stopAt(){}}}}}isDone(t){t=Math.min(t,this.state.doc.length);let e=this.fragments;return this.treeLen>=t&&e.length&&0==e[0].from&&e[0].to>=t}static get(){return St}}function At(t,e,r){return E.applyChanges(t,[{fromA:e,toA:r,fromB:e,toB:r}])}class Nt{constructor(t){this.context=t,this.tree=t.tree}apply(t){if(!t.docChanged&&this.tree==this.context.tree)return this;let e=this.context.changes(t.changes,t.state),r=this.context.treeLen==t.startState.doc.length?void 0:Math.max(t.changes.mapPos(this.context.treeLen),e.viewport.to);return e.work(20,r)||e.takeTree(),new Nt(e)}static init(t){let e=Math.min(3e3,t.doc.length),r=Ct.create(t.facet(Ot).parser,t,{from:0,to:e});return r.work(20,e)||r.takeTree(),new Nt(r)}}bt.state=e.StateField.define({create:Nt.init,update(t,e){for(let t of e.effects)if(t.is(bt.setState))return t.value;return e.startState.facet(Ot)!=e.state.facet(Ot)?Nt.init(e.state):t.apply(e)}});let Pt=t=>{let e=setTimeout((()=>t()),500);return()=>clearTimeout(e)};"undefined"!=typeof requestIdleCallback&&(Pt=t=>{let e=-1,r=setTimeout((()=>{e=requestIdleCallback(t,{timeout:400})}),100);return()=>e<0?clearTimeout(r):cancelIdleCallback(e)});const Tt="undefined"!=typeof navigator&&(null===(dt=navigator.scheduling)||void 0===dt?void 0:dt.isInputPending)?()=>navigator.scheduling.isInputPending():null,It=r.ViewPlugin.fromClass(class{constructor(t){this.view=t,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(t){let e=this.view.state.field(bt.state).context;(e.updateViewport(t.view.viewport)||this.view.viewport.to>e.treeLen)&&this.scheduleWork(),(t.docChanged||t.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(e)}scheduleWork(){if(this.working)return;let{state:t}=this.view,e=t.field(bt.state);e.tree==e.context.tree&&e.context.isDone(t.doc.length)||(this.working=Pt(this.work))}work(t){this.working=null;let e=Date.now();if(this.chunkEnd<e&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=e+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:r,viewport:{to:n}}=this.view,i=r.field(bt.state);if(i.tree==i.context.tree&&i.context.isDone(n+1e5))return;let s=Date.now()+Math.min(this.chunkBudget,100,t&&!Tt?Math.max(25,t.timeRemaining()-5):1e9),o=i.context.treeLen<n&&r.doc.length>n+1e3,l=i.context.work((()=>Tt&&Tt()||Date.now()>s),n+(o?0:1e5));this.chunkBudget-=Date.now()-e,(l||this.chunkBudget<=0)&&(i.context.takeTree(),this.view.dispatch({effects:bt.setState.of(new Nt(i.context))})),this.chunkBudget>0&&(!l||o)&&this.scheduleWork(),this.checkAsyncSchedule(i.context)}checkAsyncSchedule(t){t.scheduleOn&&(this.workScheduled++,t.scheduleOn.then((()=>this.scheduleWork())).catch((t=>r.logException(this.view.state,t))).then((()=>this.workScheduled--)),t.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),Ot=e.Facet.define({combine:t=>t.length?t[0]:null,enables:t=>[bt.state,It,r.EditorView.contentAttributes.compute([t],(e=>{let r=e.facet(t);return r&&r.name?{"data-language":r.name}:{}}))]});class Dt{constructor(t,e,r,n,i,s=void 0){this.name=t,this.alias=e,this.extensions=r,this.filename=n,this.loadFunc=i,this.support=s,this.loading=null}load(){return this.loading||(this.loading=this.loadFunc().then((t=>this.support=t),(t=>{throw this.loading=null,t})))}static of(t){let{load:e,support:r}=t;if(!e){if(!r)throw new RangeError("Must pass either 'load' or 'support' to LanguageDescription.of");e=()=>Promise.resolve(r)}return new Dt(t.name,(t.alias||[]).concat(t.name).map((t=>t.toLowerCase())),t.extensions||[],t.filename,e,r)}static matchFilename(t,e){for(let r of t)if(r.filename&&r.filename.test(e))return r;let r=/\.([^.]+)$/.exec(e);if(r)for(let e of t)if(e.extensions.indexOf(r[1])>-1)return e;return null}static matchLanguageName(t,e,r=!0){e=e.toLowerCase();for(let r of t)if(r.alias.some((t=>t==e)))return r;if(r)for(let r of t)for(let t of r.alias){let n=e.indexOf(t);if(n>-1&&(t.length>2||!/\w/.test(e[n-1])&&!/\w/.test(e[n+t.length])))return r}return null}}const Et=e.Facet.define(),Mt=e.Facet.define({combine:t=>{if(!t.length)return"  ";let e=t[0];if(!e||/\S/.test(e)||Array.from(e).some((t=>t!=e[0])))throw new Error("Invalid indent unit: "+JSON.stringify(t[0]));return e}});function Bt(t){let e=t.facet(Mt);return 9==e.charCodeAt(0)?t.tabSize*e.length:e.length}function _t(t,e){let r="",n=t.tabSize,i=t.facet(Mt)[0];if("\t"==i){for(;e>=n;)r+="\t",e-=n;i=" "}for(let t=0;t<e;t++)r+=i;return r}function Rt(t,r){t instanceof e.EditorState&&(t=new Lt(t));for(let e of t.state.facet(Et)){let n=e(t,r);if(void 0!==n)return n}let n=xt(t.state);return n.length>=r?function(t,e,r){let n=e.resolveStack(r),i=e.resolveInner(r,-1).resolve(r,0).enterUnfinishedNodesBefore(r);if(i!=n.node){let t=[];for(let e=i;e&&(e.from!=n.node.from||e.type!=n.node.type);e=e.parent)t.push(e);for(let e=t.length-1;e>=0;e--)n={node:t[e],next:n}}return Vt(n,t,r)}(t,n,r):null}class Lt{constructor(t,e={}){this.state=t,this.options=e,this.unit=Bt(t)}lineAt(t,e=1){let r=this.state.doc.lineAt(t),{simulateBreak:n,simulateDoubleBreak:i}=this.options;return null!=n&&n>=r.from&&n<=r.to?i&&n==t?{text:"",from:t}:(e<0?n<t:n<=t)?{text:r.text.slice(n-r.from),from:n}:{text:r.text.slice(0,n-r.from),from:r.from}:r}textAfterPos(t,e=1){if(this.options.simulateDoubleBreak&&t==this.options.simulateBreak)return"";let{text:r,from:n}=this.lineAt(t,e);return r.slice(t-n,Math.min(r.length,t+100-n))}column(t,e=1){let{text:r,from:n}=this.lineAt(t,e),i=this.countColumn(r,t-n),s=this.options.overrideIndentation?this.options.overrideIndentation(n):-1;return s>-1&&(i+=s-this.countColumn(r,r.search(/\S|$/))),i}countColumn(t,r=t.length){return e.countColumn(t,this.state.tabSize,r)}lineIndent(t,e=1){let{text:r,from:n}=this.lineAt(t,e),i=this.options.overrideIndentation;if(i){let t=i(n);if(t>-1)return t}return this.countColumn(r,r.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const zt=new o;function Vt(t,e,r){for(let n=t;n;n=n.next){let t=jt(n.node);if(t)return t(Wt.create(e,r,n))}return 0}function jt(t){let e=t.type.prop(zt);if(e)return e;let r,n=t.firstChild;if(n&&(r=n.type.prop(o.closedBy))){let e=t.lastChild,n=e&&r.indexOf(e.name)>-1;return t=>$t(t,!0,1,void 0,n&&!function(t){return t.pos==t.options.simulateBreak&&t.options.simulateDoubleBreak}(t)?e.from:void 0)}return null==t.parent?Ft:null}function Ft(){return 0}class Wt extends Lt{constructor(t,e,r){super(t.state,t.options),this.base=t,this.pos=e,this.context=r}get node(){return this.context.node}static create(t,e,r){return new Wt(t,e,r)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(t){let e=this.state.doc.lineAt(t.from);for(;;){let r=t.resolve(e.from);for(;r.parent&&r.parent.from==r.from;)r=r.parent;if(Ut(r,t))break;e=this.state.doc.lineAt(r.from)}return this.lineIndent(e.from)}continue(){return Vt(this.context.next,this.base,this.pos)}}function Ut(t,e){for(let r=e;r;r=r.parent)if(t==r)return!0;return!1}function $t(t,e,r,n,i){let s=t.textAfter,o=s.match(/^\s*/)[0].length,l=n&&s.slice(o,o+n.length)==n||i==t.pos+o,a=e?function(t){let e=t.node,r=e.childAfter(e.from),n=e.lastChild;if(!r)return null;let i=t.options.simulateBreak,s=t.state.doc.lineAt(r.from),o=null==i||i<=s.from?s.to:Math.min(s.to,i);for(let t=r.to;;){let i=e.childAfter(t);if(!i||i==n)return null;if(!i.type.isSkipped){if(i.from>=o)return null;let t=/^ */.exec(s.text.slice(r.to-s.from))[0].length;return{from:r.from,to:r.to+t}}t=i.to}}(t):null;return a?l?t.column(a.from):t.column(a.to):t.baseIndent+(l?0:t.unit*r)}const qt=e.Facet.define(),Ht=new o;function Jt(t){let e=t.lastChild;return e&&e.to==t.to&&e.type.isError}function Gt(t,e,r){for(let n of t.facet(qt)){let i=n(t,e,r);if(i)return i}return function(t,e,r){let n=xt(t);if(n.length<r)return null;let i=null;for(let s=n.resolveStack(r,1);s;s=s.next){let o=s.node;if(o.to<=r||o.from>r)continue;if(i&&o.from<e)break;let l=o.type.prop(Ht);if(l&&(o.to<n.length-50||n.length==t.doc.length||!Jt(o))){let n=l(o,t);n&&n.from<=r&&n.from>=e&&n.to>r&&(i=n)}}return i}(t,e,r)}function Kt(t,e){let r=e.mapPos(t.from,1),n=e.mapPos(t.to,-1);return r>=n?void 0:{from:r,to:n}}const Zt=e.StateEffect.define({map:Kt}),Qt=e.StateEffect.define({map:Kt});function Xt(t){let e=[];for(let{head:r}of t.state.selection.ranges)e.some((t=>t.from<=r&&t.to>=r))||e.push(t.lineBlockAt(r));return e}const Yt=e.StateField.define({create:()=>r.Decoration.none,update(t,e){t=t.map(e.changes);for(let n of e.effects)if(n.is(Zt)&&!ee(t,n.value.from,n.value.to)){let{preparePlaceholder:i}=e.state.facet(fe),s=i?r.Decoration.replace({widget:new ge(i(e.state,n.value))}):pe;t=t.update({add:[s.range(n.value.from,n.value.to)]})}else n.is(Qt)&&(t=t.update({filter:(t,e)=>n.value.from!=t||n.value.to!=e,filterFrom:n.value.from,filterTo:n.value.to}));if(e.selection){let r=!1,{head:n}=e.selection.main;t.between(n,n,((t,e)=>{t<n&&e>n&&(r=!0)})),r&&(t=t.update({filterFrom:n,filterTo:n,filter:(t,e)=>e<=n||t>=n}))}return t},provide:t=>r.EditorView.decorations.from(t),toJSON(t,e){let r=[];return t.between(0,e.doc.length,((t,e)=>{r.push(t,e)})),r},fromJSON(t){if(!Array.isArray(t)||t.length%2)throw new RangeError("Invalid JSON for fold state");let e=[];for(let r=0;r<t.length;){let n=t[r++],i=t[r++];if("number"!=typeof n||"number"!=typeof i)throw new RangeError("Invalid JSON for fold state");e.push(pe.range(n,i))}return r.Decoration.set(e,!0)}});function te(t,e,r){var n;let i=null;return null===(n=t.field(Yt,!1))||void 0===n||n.between(e,r,((t,e)=>{(!i||i.from>t)&&(i={from:t,to:e})})),i}function ee(t,e,r){let n=!1;return t.between(e,e,((t,i)=>{t==e&&i==r&&(n=!0)})),n}function re(t,r){return t.field(Yt,!1)?r:r.concat(e.StateEffect.appendConfig.of(ce()))}const ne=t=>{for(let e of Xt(t)){let r=Gt(t.state,e.from,e.to);if(r)return t.dispatch({effects:re(t.state,[Zt.of(r),se(t,r)])}),!0}return!1},ie=t=>{if(!t.state.field(Yt,!1))return!1;let e=[];for(let r of Xt(t)){let n=te(t.state,r.from,r.to);n&&e.push(Qt.of(n),se(t,n,!1))}return e.length&&t.dispatch({effects:e}),e.length>0};function se(t,e,n=!0){let i=t.state.doc.lineAt(e.from).number,s=t.state.doc.lineAt(e.to).number;return r.EditorView.announce.of(`${t.state.phrase(n?"Folded lines":"Unfolded lines")} ${i} ${t.state.phrase("to")} ${s}.`)}const oe=t=>{let{state:e}=t,r=[];for(let n=0;n<e.doc.length;){let i=t.lineBlockAt(n),s=Gt(e,i.from,i.to);s&&r.push(Zt.of(s)),n=(s?t.lineBlockAt(s.to):i).to+1}return r.length&&t.dispatch({effects:re(t.state,r)}),!!r.length},le=t=>{let e=t.state.field(Yt,!1);if(!e||!e.size)return!1;let r=[];return e.between(0,t.state.doc.length,((t,e)=>{r.push(Qt.of({from:t,to:e}))})),t.dispatch({effects:r}),!0};function ae(t,e){for(let r=e;;){let n=Gt(t.state,r.from,r.to);if(n&&n.to>e.from)return n;if(!r.from)return null;r=t.lineBlockAt(r.from-1)}}const he=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:ne},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:ie},{key:"Ctrl-Alt-[",run:oe},{key:"Ctrl-Alt-]",run:le}],ue={placeholderDOM:null,preparePlaceholder:null,placeholderText:"…"},fe=e.Facet.define({combine:t=>e.combineConfig(t,ue)});function ce(t){let e=[Yt,ye];return t&&e.push(fe.of(t)),e}function de(t,e){let{state:r}=t,n=r.facet(fe),i=e=>{let r=t.lineBlockAt(t.posAtDOM(e.target)),n=te(t.state,r.from,r.to);n&&t.dispatch({effects:Qt.of(n)}),e.preventDefault()};if(n.placeholderDOM)return n.placeholderDOM(t,i,e);let s=document.createElement("span");return s.textContent=n.placeholderText,s.setAttribute("aria-label",r.phrase("folded code")),s.title=r.phrase("unfold"),s.className="cm-foldPlaceholder",s.onclick=i,s}const pe=r.Decoration.replace({widget:new class extends r.WidgetType{toDOM(t){return de(t,null)}}});class ge extends r.WidgetType{constructor(t){super(),this.value=t}eq(t){return this.value==t.value}toDOM(t){return de(t,this.value)}}const me={openText:"⌄",closedText:"›",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class be extends r.GutterMarker{constructor(t,e){super(),this.config=t,this.open=e}eq(t){return this.config==t.config&&this.open==t.open}toDOM(t){if(this.config.markerDOM)return this.config.markerDOM(this.open);let e=document.createElement("span");return e.textContent=this.open?this.config.openText:this.config.closedText,e.title=t.state.phrase(this.open?"Fold line":"Unfold line"),e}}const ye=r.EditorView.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class ke{constructor(t,e){let r;function n(t){let e=ut.newName();return(r||(r=Object.create(null)))["."+e]=t,e}this.specs=t;const i="string"==typeof e.all?e.all:e.all?n(e.all):void 0,s=e.scope;this.scope=s instanceof bt?t=>t.prop(pt)==s.data:s?t=>t==s:void 0,this.style=W(t.map((t=>({tag:t.tag,class:t.class||n(Object.assign({},t,{tag:null}))}))),{all:i}).style,this.module=r?new ut(r):null,this.themeType=e.themeType}static define(t,e){return new ke(t,e||{})}}const xe=e.Facet.define(),we=e.Facet.define({combine:t=>t.length?[t[0]]:null});function ve(t){let e=t.facet(xe);return e.length?e:t.facet(we)}class Se{constructor(t){this.markCache=Object.create(null),this.tree=xt(t.state),this.decorations=this.buildDeco(t,ve(t.state)),this.decoratedTo=t.viewport.to}update(t){let e=xt(t.state),r=ve(t.state),n=r!=ve(t.startState),{viewport:i}=t.view,s=t.changes.mapPos(this.decoratedTo,1);e.length<i.to&&!n&&e.type==this.tree.type&&s>=i.to?(this.decorations=this.decorations.map(t.changes),this.decoratedTo=s):(e!=this.tree||t.viewportChanged||n)&&(this.tree=e,this.decorations=this.buildDeco(t.view,r),this.decoratedTo=i.to)}buildDeco(t,n){if(!n||!this.tree.length)return r.Decoration.none;let i=new e.RangeSetBuilder;for(let{from:e,to:s}of t.visibleRanges)U(this.tree,n,((t,e,n)=>{i.add(t,e,this.markCache[n]||(this.markCache[n]=r.Decoration.mark({class:n})))}),e,s);return i.finish()}}const Ce=e.Prec.high(r.ViewPlugin.fromClass(Se,{decorations:t=>t.decorations})),Ae=ke.define([{tag:ot.meta,color:"#404740"},{tag:ot.link,textDecoration:"underline"},{tag:ot.heading,textDecoration:"underline",fontWeight:"bold"},{tag:ot.emphasis,fontStyle:"italic"},{tag:ot.strong,fontWeight:"bold"},{tag:ot.strikethrough,textDecoration:"line-through"},{tag:ot.keyword,color:"#708"},{tag:[ot.atom,ot.bool,ot.url,ot.contentSeparator,ot.labelName],color:"#219"},{tag:[ot.literal,ot.inserted],color:"#164"},{tag:[ot.string,ot.deleted],color:"#a11"},{tag:[ot.regexp,ot.escape,ot.special(ot.string)],color:"#e40"},{tag:ot.definition(ot.variableName),color:"#00f"},{tag:ot.local(ot.variableName),color:"#30a"},{tag:[ot.typeName,ot.namespace],color:"#085"},{tag:ot.className,color:"#167"},{tag:[ot.special(ot.variableName),ot.macroName],color:"#256"},{tag:ot.definition(ot.propertyName),color:"#00c"},{tag:ot.comment,color:"#940"},{tag:ot.invalid,color:"#f00"}]),Ne=r.EditorView.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),Pe="()[]{}",Te=e.Facet.define({combine:t=>e.combineConfig(t,{afterCursor:!0,brackets:Pe,maxScanDistance:1e4,renderMatch:De})}),Ie=r.Decoration.mark({class:"cm-matchingBracket"}),Oe=r.Decoration.mark({class:"cm-nonmatchingBracket"});function De(t){let e=[],r=t.matched?Ie:Oe;return e.push(r.range(t.start.from,t.start.to)),t.end&&e.push(r.range(t.end.from,t.end.to)),e}const Ee=[e.StateField.define({create:()=>r.Decoration.none,update(t,e){if(!e.docChanged&&!e.selection)return t;let n=[],i=e.state.facet(Te);for(let t of e.state.selection.ranges){if(!t.empty)continue;let r=Re(e.state,t.head,-1,i)||t.head>0&&Re(e.state,t.head-1,1,i)||i.afterCursor&&(Re(e.state,t.head,1,i)||t.head<e.state.doc.length&&Re(e.state,t.head+1,-1,i));r&&(n=n.concat(i.renderMatch(r,e.state)))}return r.Decoration.set(n,!0)},provide:t=>r.EditorView.decorations.from(t)}),Ne];const Me=new o;function Be(t,e,r){let n=t.prop(e<0?o.openedBy:o.closedBy);if(n)return n;if(1==t.name.length){let n=r.indexOf(t.name);if(n>-1&&n%2==(e<0?1:0))return[r[n+e]]}return null}function _e(t){let e=t.type.prop(Me);return e?e(t.node):t}function Re(t,e,r,n={}){let i=n.maxScanDistance||1e4,s=n.brackets||Pe,o=xt(t),l=o.resolveInner(e,r);for(let n=l;n;n=n.parent){let i=Be(n.type,r,s);if(i&&n.from<n.to){let o=_e(n);if(o&&(r>0?e>=o.from&&e<o.to:e>o.from&&e<=o.to))return Le(t,e,r,n,o,i,s)}}return function(t,e,r,n,i,s,o){let l=r<0?t.sliceDoc(e-1,e):t.sliceDoc(e,e+1),a=o.indexOf(l);if(a<0||a%2==0!=r>0)return null;let h={from:r<0?e-1:e,to:r>0?e+1:e},u=t.doc.iterRange(e,r>0?t.doc.length:0),f=0;for(let t=0;!u.next().done&&t<=s;){let s=u.value;r<0&&(t+=s.length);let l=e+t*r;for(let t=r>0?0:s.length-1,e=r>0?s.length:-1;t!=e;t+=r){let e=o.indexOf(s[t]);if(!(e<0||n.resolveInner(l+t,1).type!=i))if(e%2==0==r>0)f++;else{if(1==f)return{start:h,end:{from:l+t,to:l+t+1},matched:e>>1==a>>1};f--}}r>0&&(t+=s.length)}return u.done?{start:h,matched:!1}:null}(t,e,r,o,l.type,i,s)}function Le(t,e,r,n,i,s,o){let l=n.parent,a={from:i.from,to:i.to},h=0,u=null==l?void 0:l.cursor();if(u&&(r<0?u.childBefore(n.from):u.childAfter(n.to)))do{if(r<0?u.to<=n.from:u.from>=n.to){if(0==h&&s.indexOf(u.type.name)>-1&&u.from<u.to){let t=_e(u);return{start:a,end:t?{from:t.from,to:t.to}:void 0,matched:!0}}if(Be(u.type,r,o))h++;else if(Be(u.type,-r,o)){if(0==h){let t=_e(u);return{start:a,end:t&&t.from<t.to?{from:t.from,to:t.to}:void 0,matched:!1}}h--}}}while(r<0?u.prevSibling():u.nextSibling());return{start:a,matched:!1}}function ze(t,e,r,n=0,i=0){null==e&&-1==(e=t.search(/[^\s\u00a0]/))&&(e=t.length);let s=i;for(let i=n;i<e;i++)9==t.charCodeAt(i)?s+=r-s%r:s++;return s}class Ve{constructor(t,e,r,n){this.string=t,this.tabSize=e,this.indentUnit=r,this.overrideIndent=n,this.pos=0,this.start=0,this.lastColumnPos=0,this.lastColumnValue=0}eol(){return this.pos>=this.string.length}sol(){return 0==this.pos}peek(){return this.string.charAt(this.pos)||void 0}next(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}eat(t){let e,r=this.string.charAt(this.pos);if(e="string"==typeof t?r==t:r&&(t instanceof RegExp?t.test(r):t(r)),e)return++this.pos,r}eatWhile(t){let e=this.pos;for(;this.eat(t););return this.pos>e}eatSpace(){let t=this.pos;for(;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>t}skipToEnd(){this.pos=this.string.length}skipTo(t){let e=this.string.indexOf(t,this.pos);if(e>-1)return this.pos=e,!0}backUp(t){this.pos-=t}column(){return this.lastColumnPos<this.start&&(this.lastColumnValue=ze(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue}indentation(){var t;return null!==(t=this.overrideIndent)&&void 0!==t?t:ze(this.string,null,this.tabSize)}match(t,e,r){if("string"==typeof t){let n=t=>r?t.toLowerCase():t;return n(this.string.substr(this.pos,t.length))==n(t)?(!1!==e&&(this.pos+=t.length),!0):null}{let r=this.string.slice(this.pos).match(t);return r&&r.index>0?null:(r&&!1!==e&&(this.pos+=r[0].length),r)}}current(){return this.string.slice(this.start,this.pos)}}function je(t){if("object"!=typeof t)return t;let e={};for(let r in t){let n=t[r];e[r]=n instanceof Array?n.slice():n}return e}const Fe=new WeakMap;class We extends bt{constructor(t){let e,r=gt(t.languageData),n={name:(i=t).name||"",token:i.token,blankLine:i.blankLine||(()=>{}),startState:i.startState||(()=>!0),copyState:i.copyState||je,indent:i.indent||(()=>null),languageData:i.languageData||{},tokenTable:i.tokenTable||Je,mergeTokens:!1!==i.mergeTokens};var i;super(r,new class extends M{createParse(t,r,n){return new qe(e,t,r,n)}},[],t.name),this.topNode=function(t,e){let r=h.define({id:Ge.length,name:"Document",props:[pt.add((()=>t)),zt.add((()=>t=>e.getIndent(t)))],top:!0});return Ge.push(r),r}(r,this),e=this,this.streamParser=n,this.stateAfter=new o({perNode:!0}),this.tokenTable=t.tokenTable?new Ye(n.tokenTable):tr}static define(t){return new We(t)}getIndent(t){let e,{overrideIndentation:r}=t.options;r&&(e=Fe.get(t.state),null!=e&&e<t.pos-1e4&&(e=void 0));let n,i,s=Ue(this,t.node.tree,t.node.from,t.node.from,null!=e?e:t.pos);if(s?(i=s.state,n=s.pos+1):(i=this.streamParser.startState(t.unit),n=t.node.from),t.pos-n>1e4)return null;for(;n<t.pos;){let e=t.state.doc.lineAt(n),s=Math.min(t.pos,e.to);if(e.length){let n=r?r(e.from):-1,o=new Ve(e.text,t.state.tabSize,t.unit,n<0?void 0:n);for(;o.pos<s-e.from;)He(this.streamParser.token,o,i)}else this.streamParser.blankLine(i,t.unit);if(s==t.pos)break;n=e.to+1}let o=t.lineAt(t.pos);return r&&null==e&&Fe.set(t.state,o.from),this.streamParser.indent(i,/^\s*(.*)/.exec(o.text)[1],t)}get allowsNesting(){return!1}}function Ue(t,e,r,n,i){let s=r>=n&&r+e.length<=i&&e.prop(t.stateAfter);if(s)return{state:t.streamParser.copyState(s),pos:r+e.length};for(let s=e.children.length-1;s>=0;s--){let o=e.children[s],l=r+e.positions[s],a=o instanceof p&&l<i&&Ue(t,o,l,n,i);if(a)return a}return null}function $e(t,e,r,n,i){if(i&&r<=0&&n>=e.length)return e;i||0!=r||e.type!=t.topNode||(i=!0);for(let s=e.children.length-1;s>=0;s--){let o,l=e.positions[s],a=e.children[s];if(l<n&&a instanceof p){if(!(o=$e(t,a,r-l,n-l,i)))break;return i?new p(e.type,e.children.slice(0,s).concat(o),e.positions.slice(0,s+1),l+o.length):o}}return null}class qe{constructor(t,e,r,n){this.lang=t,this.input=e,this.fragments=r,this.ranges=n,this.stoppedAt=null,this.chunks=[],this.chunkPos=[],this.chunk=[],this.chunkReused=void 0,this.rangeIndex=0,this.to=n[n.length-1].to;let i=Ct.get(),s=n[0].from,{state:o,tree:l}=function(t,e,r,n,i){for(let i of e){let e,s=i.from+(i.openStart?25:0),o=i.to-(i.openEnd?25:0),l=s<=r&&o>r&&Ue(t,i.tree,0-i.offset,r,o);if(l&&l.pos<=n&&(e=$e(t,i.tree,r+i.offset,l.pos+i.offset,!1)))return{state:l.state,tree:e}}return{state:t.streamParser.startState(i?Bt(i):4),tree:p.empty}}(t,r,s,this.to,null==i?void 0:i.state);this.state=o,this.parsedPos=this.chunkStart=s+l.length;for(let t=0;t<l.children.length;t++)this.chunks.push(l.children[t]),this.chunkPos.push(l.positions[t]);i&&this.parsedPos<i.viewport.from-1e5&&n.some((t=>t.from<=i.viewport.from&&t.to>=i.viewport.from))&&(this.state=this.lang.streamParser.startState(Bt(i.state)),i.skipUntilInView(this.parsedPos,i.viewport.from),this.parsedPos=i.viewport.from),this.moveRangeIndex()}advance(){let t=Ct.get(),e=null==this.stoppedAt?this.to:Math.min(this.to,this.stoppedAt),r=Math.min(e,this.chunkStart+2048);for(t&&(r=Math.min(r,t.viewport.to));this.parsedPos<r;)this.parseLine(t);return this.chunkStart<this.parsedPos&&this.finishChunk(),this.parsedPos>=e?this.finish():t&&this.parsedPos>=t.viewport.to?(t.skipUntilInView(this.parsedPos,e),this.finish()):null}stopAt(t){this.stoppedAt=t}lineAfter(t){let e=this.input.chunk(t);if(this.input.lineChunks)"\n"==e&&(e="");else{let t=e.indexOf("\n");t>-1&&(e=e.slice(0,t))}return t+e.length<=this.to?e:e.slice(0,this.to-t)}nextLine(){let t=this.parsedPos,e=this.lineAfter(t),r=t+e.length;for(let t=this.rangeIndex;;){let n=this.ranges[t].to;if(n>=r)break;if(e=e.slice(0,n-(r-e.length)),t++,t==this.ranges.length)break;let i=this.ranges[t].from,s=this.lineAfter(i);e+=s,r=i+s.length}return{line:e,end:r}}skipGapsTo(t,e,r){for(;;){let n=this.ranges[this.rangeIndex].to,i=t+e;if(r>0?n>i:n>=i)break;e+=this.ranges[++this.rangeIndex].from-n}return e}moveRangeIndex(){for(;this.ranges[this.rangeIndex].to<this.parsedPos;)this.rangeIndex++}emitToken(t,e,r,n){let i=4;if(this.ranges.length>1){e+=n=this.skipGapsTo(e,n,1);let t=this.chunk.length;r+=n=this.skipGapsTo(r,n,-1),i+=this.chunk.length-t}let s=this.chunk.length-4;return this.lang.streamParser.mergeTokens&&4==i&&s>=0&&this.chunk[s]==t&&this.chunk[s+2]==e?this.chunk[s+2]=r:this.chunk.push(t,e,r,i),n}parseLine(t){let{line:e,end:r}=this.nextLine(),n=0,{streamParser:i}=this.lang,s=new Ve(e,t?t.state.tabSize:4,t?Bt(t.state):2);if(s.eol())i.blankLine(this.state,s.indentUnit);else for(;!s.eol();){let t=He(i.token,s,this.state);if(t&&(n=this.emitToken(this.lang.tokenTable.resolve(t),this.parsedPos+s.start,this.parsedPos+s.pos,n)),s.start>1e4)break}this.parsedPos=r,this.moveRangeIndex(),this.parsedPos<this.to&&this.parsedPos++}finishChunk(){let t=p.build({buffer:this.chunk,start:this.chunkStart,length:this.parsedPos-this.chunkStart,nodeSet:Ke,topID:0,maxBufferLength:2048,reused:this.chunkReused});t=new p(t.type,t.children,t.positions,t.length,[[this.lang.stateAfter,this.lang.streamParser.copyState(this.state)]]),this.chunks.push(t),this.chunkPos.push(this.chunkStart-this.ranges[0].from),this.chunk=[],this.chunkReused=void 0,this.chunkStart=this.parsedPos}finish(){return new p(this.lang.topNode,this.chunks,this.chunkPos,this.parsedPos-this.ranges[0].from).balance()}}function He(t,e,r){e.start=e.pos;for(let n=0;n<10;n++){let n=t(e,r);if(e.pos>e.start)return n}throw new Error("Stream parser failed to advance stream.")}const Je=Object.create(null),Ge=[h.none],Ke=new u(Ge),Ze=[],Qe=Object.create(null),Xe=Object.create(null);for(let[t,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])Xe[t]=rr(Je,e);class Ye{constructor(t){this.extra=t,this.table=Object.assign(Object.create(null),Xe)}resolve(t){return t?this.table[t]||(this.table[t]=rr(this.extra,t)):0}}const tr=new Ye(Je);function er(t,e){Ze.indexOf(t)>-1||(Ze.push(t),console.warn(e))}function rr(t,e){let r=[];for(let n of e.split(" ")){let e=[];for(let r of n.split(".")){let n=t[r]||ot[r];n?"function"==typeof n?e.length?e=e.map(n):er(r,`Modifier ${r} used at start of tag`):e.length?er(r,`Tag ${r} used as modifier`):e=Array.isArray(n)?n:[n]:er(r,`Unknown highlighting tag ${r}`)}for(let t of e)r.push(t)}if(!r.length)return 0;let n=e.replace(/ /g,"_"),i=n+" "+r.map((t=>t.id)),s=Qe[i];if(s)return s.id;let o=Qe[i]=h.define({id:Ge.length,name:n,props:[V({[n]:r})]});return Ge.push(o),o.id}function nr(t){return t.length<=4096&&/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/.test(t)}function ir(t){for(let e=t.iter();!e.next().done;)if(nr(e.value))return!0;return!1}const sr=e.Facet.define({combine:t=>t.some((t=>t))});const or=r.ViewPlugin.fromClass(class{constructor(t){this.always=t.state.facet(sr)||t.textDirection!=r.Direction.LTR||t.state.facet(r.EditorView.perLineTextDirection),this.hasRTL=!this.always&&ir(t.state.doc),this.tree=xt(t.state),this.decorations=this.always||this.hasRTL?lr(t,this.tree,this.always):r.Decoration.none}update(t){let e=t.state.facet(sr)||t.view.textDirection!=r.Direction.LTR||t.state.facet(r.EditorView.perLineTextDirection);if(e||this.hasRTL||!function(t){let e=!1;return t.iterChanges(((t,r,n,i,s)=>{!e&&ir(s)&&(e=!0)})),e}(t.changes)||(this.hasRTL=!0),!e&&!this.hasRTL)return;let n=xt(t.state);(e!=this.always||n!=this.tree||t.docChanged||t.viewportChanged)&&(this.tree=n,this.always=e,this.decorations=lr(t.view,n,e))}},{provide:t=>{function n(e){var n,i;return null!==(i=null===(n=e.plugin(t))||void 0===n?void 0:n.decorations)&&void 0!==i?i:r.Decoration.none}return[r.EditorView.outerDecorations.of(n),e.Prec.lowest(r.EditorView.bidiIsolatedRanges.of(n))]}});function lr(t,r,n){let i=new e.RangeSetBuilder,s=t.visibleRanges;n||(s=function(t,e){let r=e.iter(),n=0,i=[],s=null;for(let{from:e,to:o}of t)if(!(s&&s.to>e&&(e=s.to,e>=o)))for(n+r.value.length<e&&(r.next(e-(n+r.value.length)),n=e);;){let t=n,e=n+r.value.length;if(!r.lineBreak&&nr(r.value)&&(s&&s.to>t-10?s.to=Math.min(o,e):i.push(s={from:t,to:Math.min(o,e)})),e>=o)break;n=e,r.next()}return i}(s,t.state.doc));for(let{from:t,to:e}of s)r.iterate({enter:t=>{let e=t.type.prop(o.isolate);e&&i.add(t.from,t.to,ar[e])},from:t,to:e});return i.finish()}const ar={rtl:r.Decoration.mark({class:"cm-iso",inclusive:!0,attributes:{dir:"rtl"},bidiIsolate:r.Direction.RTL}),ltr:r.Decoration.mark({class:"cm-iso",inclusive:!0,attributes:{dir:"ltr"},bidiIsolate:r.Direction.LTR}),auto:r.Decoration.mark({class:"cm-iso",inclusive:!0,attributes:{dir:"auto"},bidiIsolate:null})};return t.DocInput=vt,t.HighlightStyle=ke,t.IndentContext=Lt,t.LRLanguage=kt,t.Language=bt,t.LanguageDescription=Dt,t.LanguageSupport=class{constructor(t,e=[]){this.language=t,this.support=e,this.extension=[t,e]}},t.ParseContext=Ct,t.StreamLanguage=We,t.StringStream=Ve,t.TreeIndentContext=Wt,t.bidiIsolates=function(t={}){let e=[or];return t.alwaysIsolate&&e.push(sr.of(!0)),e},t.bracketMatching=function(t={}){return[Te.of(t),Ee]},t.bracketMatchingHandle=Me,t.codeFolding=ce,t.continuedIndent=function({except:t,units:e=1}={}){return r=>{let n=t&&t.test(r.textAfter);return r.baseIndent+(n?0:e*r.unit)}},t.defaultHighlightStyle=Ae,t.defineLanguageFacet=gt,t.delimitedIndent=function({closing:t,align:e=!0,units:r=1}){return n=>$t(n,e,r,t)},t.ensureSyntaxTree=wt,t.flatIndent=t=>t.baseIndent,t.foldAll=oe,t.foldCode=ne,t.foldEffect=Zt,t.foldGutter=function(t={}){let n=Object.assign(Object.assign({},me),t),i=new be(n,!0),s=new be(n,!1),o=r.ViewPlugin.fromClass(class{constructor(t){this.from=t.viewport.from,this.markers=this.buildMarkers(t)}update(t){(t.docChanged||t.viewportChanged||t.startState.facet(Ot)!=t.state.facet(Ot)||t.startState.field(Yt,!1)!=t.state.field(Yt,!1)||xt(t.startState)!=xt(t.state)||n.foldingChanged(t))&&(this.markers=this.buildMarkers(t.view))}buildMarkers(t){let r=new e.RangeSetBuilder;for(let e of t.viewportLineBlocks){let n=te(t.state,e.from,e.to)?s:Gt(t.state,e.from,e.to)?i:null;n&&r.add(e.from,e.from,n)}return r.finish()}}),{domEventHandlers:l}=n;return[o,r.gutter({class:"cm-foldGutter",markers(t){var r;return(null===(r=t.plugin(o))||void 0===r?void 0:r.markers)||e.RangeSet.empty},initialSpacer:()=>new be(n,!1),domEventHandlers:Object.assign(Object.assign({},l),{click:(t,e,r)=>{if(l.click&&l.click(t,e,r))return!0;let n=te(t.state,e.from,e.to);if(n)return t.dispatch({effects:Qt.of(n)}),!0;let i=Gt(t.state,e.from,e.to);return!!i&&(t.dispatch({effects:Zt.of(i)}),!0)}})}),ce()]},t.foldInside=function(t){let e=t.firstChild,r=t.lastChild;return e&&e.to<r.from?{from:e.to,to:r.type.isError?t.to:r.from}:null},t.foldKeymap=he,t.foldNodeProp=Ht,t.foldService=qt,t.foldState=Yt,t.foldable=Gt,t.foldedRanges=function(t){return t.field(Yt,!1)||e.RangeSet.empty},t.forceParsing=function(t,e=t.viewport.to,r=100){let n=wt(t.state,e,r);return n!=xt(t.state)&&t.dispatch({}),!!n},t.getIndentUnit=Bt,t.getIndentation=Rt,t.highlightingFor=function(t,e,r){let n=ve(t),i=null;if(n)for(let t of n)if(!t.scope||r&&t.scope(r)){let r=t.style(e);r&&(i=i?i+" "+r:r)}return i},t.indentNodeProp=zt,t.indentOnInput=function(){return e.EditorState.transactionFilter.of((t=>{if(!t.docChanged||!t.isUserEvent("input.type")&&!t.isUserEvent("input.complete"))return t;let e=t.startState.languageDataAt("indentOnInput",t.startState.selection.main.head);if(!e.length)return t;let r=t.newDoc,{head:n}=t.newSelection.main,i=r.lineAt(n);if(n>i.from+200)return t;let s=r.sliceString(i.from,n);if(!e.some((t=>t.test(s))))return t;let{state:o}=t,l=-1,a=[];for(let{head:t}of o.selection.ranges){let e=o.doc.lineAt(t);if(e.from==l)continue;l=e.from;let r=Rt(o,e.from);if(null==r)continue;let n=/^\s*/.exec(e.text)[0],i=_t(o,r);n!=i&&a.push({from:e.from,to:e.from+n.length,insert:i})}return a.length?[t,{changes:a,sequential:!0}]:t}))},t.indentRange=function(t,e,r){let n=Object.create(null),i=new Lt(t,{overrideIndentation:t=>{var e;return null!==(e=n[t])&&void 0!==e?e:-1}}),s=[];for(let o=e;o<=r;){let e=t.doc.lineAt(o);o=e.to+1;let r=Rt(i,e.from);if(null==r)continue;/\S/.test(e.text)||(r=0);let l=/^\s*/.exec(e.text)[0],a=_t(t,r);l!=a&&(n[e.from]=r,s.push({from:e.from,to:e.from+l.length,insert:a}))}return t.changes(s)},t.indentService=Et,t.indentString=_t,t.indentUnit=Mt,t.language=Ot,t.languageDataProp=pt,t.matchBrackets=Re,t.sublanguageProp=mt,t.syntaxHighlighting=function(t,e){let n,i=[Ce];return t instanceof ke&&(t.module&&i.push(r.EditorView.styleModule.of(t.module)),n=t.themeType),(null==e?void 0:e.fallback)?i.push(we.of(t)):n?i.push(xe.computeN([r.EditorView.darkTheme],(e=>e.facet(r.EditorView.darkTheme)==("dark"==n)?[t]:[]))):i.push(xe.of(t)),i},t.syntaxParserRunning=function(t){var e;return(null===(e=t.plugin(It))||void 0===e?void 0:e.isWorking())||!1},t.syntaxTree=xt,t.syntaxTreeAvailable=function(t,e=t.doc.length){var r;return(null===(r=t.field(bt.state,!1))||void 0===r?void 0:r.context.isDone(e))||!1},t.toggleFold=t=>{let e=[];for(let r of Xt(t)){let n=te(t.state,r.from,r.to);if(n)e.push(Qt.of(n),se(t,n,!1));else{let n=ae(t,r);n&&e.push(Zt.of(n),se(t,n))}}return e.length>0&&t.dispatch({effects:re(t.state,e)}),!!e.length},t.unfoldAll=le,t.unfoldCode=ie,t.unfoldEffect=Qt,t}({},CM.state,CM.view);
